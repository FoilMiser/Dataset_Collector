schema_version: "0.9"
updated_utc: "2025-12-30"

companion_files:
  license_map: "./license_map.yaml"
  field_schemas: "./field_schemas.yaml"
  denylist: "./denylist.yaml"

globals:
  raw_root: /data/logic/raw
  screened_yellow_root: /data/logic/screened_yellow
  combined_root: /data/logic/combined
  ledger_root: /data/logic/_ledger
  pitches_root: /data/logic/_pitches
  manifests_root: /data/logic/_manifests
  queues_root: /data/logic/_queues
  catalogs_root: /data/logic/_catalogs
  logs_root: /data/logic/_logs

  require_yellow_signoff: true

  sharding:
    max_records_per_shard: 50000
    compression: gzip

  screening:
    min_chars: 200
    max_chars: 12000
    text_field_candidates:
      - text
      - content
      - body
      - statement
      - problem
      - prompt
    record_license_field_candidates:
      - license
      - license_spdx
    require_record_license: false
    allow_spdx:
      - CC-BY-4.0
      - CC0-1.0
      - MIT
      - Apache-2.0
      - CC-BY-SA-4.0
    deny_phrases:
      - noai
      - "no tdm"
      - "no machine learning"

  default_gates:
    - snapshot_terms
    - restriction_phrase_scan

queues:
  emit:
    - id: "green_download"
      path: "/data/logic/_queues/green_download.jsonl"
      criteria:
        effective_bucket: "GREEN"
        enabled: true
    - id: "yellow_pipeline"
      path: "/data/logic/_queues/yellow_pipeline.jsonl"
      criteria:
        effective_bucket: "YELLOW"
        enabled: true
    - id: "red_rejected"
      path: "/data/logic/_queues/red_rejected.jsonl"
      criteria:
        effective_bucket: "RED"
        enabled: true

gates_catalog:
  snapshot_terms: "Save Terms/ToS + license page HTML/PDF/TXT + retrieval timestamp."
  resolve_license_spdx: "Future work: Normalize license to SPDX via license_map.yaml rules; store evidence."
  restriction_phrase_scan: "Scan terms/content for restriction phrases (no-LLM/no-TDM/etc.)."
  record_level_filter: "Require per-record license metadata; keep only allowlist."
  extract_text_chunks: "Extract text into JSONL chunks using globals.text_processing_defaults unless overridden."
  emit_training_manifest: "Future work: Manifest of included files/records + checksums + license evidence."
  emit_attribution_bundle: "Future work: Generate ATTRIBUTION.md + CITATIONS.bib for included sources."
  manual_legal_review: "Human review required before training."
  segregate_copyleft_pool: "Force output into copyleft pool and keep isolated."
  near_duplicate_detection: "Run MinHash/LSH deduplication pass."
  split_aware_partition: "Partition data respecting split_group_id for leak prevention."

resolvers:
  github:
    mode: "release"
    api_base: "https://api.github.com"
    rate_limit:
      requests_per_hour: 60
      retry_on_403: true
      exponential_backoff: true
    endpoints:
      releases: "/repos/{owner}/{repo}/releases"
      latest: "/repos/{owner}/{repo}/releases/latest"
      assets: "/repos/{owner}/{repo}/releases/{release_id}/assets"
    note: "Use GITHUB_TOKEN env var for higher rate limits."
  huggingface_datasets:
    mode: "dataset_id"
    note: "Use datasets.load_dataset; capture dataset card + license field."
  git:
    mode: "repo"
    note: "Capture commit hash; store LICENSE + README as evidence."
  http:
    mode: "direct_url"
    note: "Direct file download with resume."
  ftp:
    mode: "base_url + globs"
    note: "List + filter by glob; store directory listing snapshot (planned)."
  zenodo:
    mode: "record_id_or_doi"
    api: "https://zenodo.org/api/records/{record_id}"
    outputs:
      - "files[*].links.self"
      - "files[*].checksum"
    verify_checksum: true
    checksum_algorithm: "md5"
  dataverse:
    mode: "persistent_id"
    default_instance: "https://dataverse.harvard.edu"

targets:
  - id: "synthetic_logic_problems"
    name: "Your generated deterministic logic problems (auto-graded)"
    enabled: false
    priority: 10
    license_profile: "permissive"
    license_evidence:
      spdx_hint: "MIT"
      url: ""
    notes: "Set this to the SPDX you grant yourself (e.g., MIT or CC0) so it classifies as GREEN."
    data_type: ["synthetic", "logic", "problems", "curriculum"]
    download:
      strategy: "none"
    build:
      owner: "you"
      output_formats: ["jsonl"]
      required_fields:
        - "problem_id"
        - "domain"
        - "difficulty"
        - "prompt"
        - "answer_key"
        - "grading_fn"
        - "metadata"
    routing:
      subject: logic
      domain: propositional_logic
      category: truth_tables
      granularity: target

  - id: "lean_mathlib4"
    name: "Lean mathlib4 (formal proofs)"
    enabled: true
    priority: 10
    publisher: "mathlib"
    license_profile: "permissive"
    license_evidence:
      spdx_hint: "UNKNOWN"
      url: "https://raw.githubusercontent.com/leanprover-community/mathlib4/master/LICENSE"
    data_type: ["formal_proofs", "lean", "theorems", "tactics"]
    download:
      strategy: "git"
      repo: "https://github.com/leanprover-community/mathlib4.git"
      checkout: "master"
    output:
      pool: "permissive"
      formats: ["git"]
    routing:
      subject: logic
      domain: proof_assistants
      category: lean_formal_proofs
      granularity: target

  - id: "metamath_setmm"
    name: "Metamath set.mm (formal proofs)"
    enabled: true
    priority: 9
    publisher: "metamath"
    license_profile: "permissive"
    license_evidence:
      spdx_hint: "UNKNOWN"
      url: "https://raw.githubusercontent.com/metamath/set.mm/master/LICENSE"
    data_type: ["formal_proofs", "metamath", "theorems", "proofs"]
    download:
      strategy: "git"
      repo: "https://github.com/metamath/set.mm.git"
      checkout: "master"
    output:
      pool: "permissive"
      formats: ["git"]
    routing:
      subject: logic
      domain: proof_assistants
      category: metamath_formal_proofs
      granularity: target

  - id: "open_logic_project"
    name: "Open Logic Project (open textbook + LaTeX sources)"
    enabled: true
    priority: 8
    publisher: "openlogicproject"
    license_profile: "permissive"
    license_evidence:
      spdx_hint: "UNKNOWN"
      url: "https://raw.githubusercontent.com/OpenLogicProject/OpenLogic/master/LICENSE"
    data_type: ["textbooks", "logic", "explanations", "latex"]
    download:
      strategy: "git"
      repo: "https://github.com/OpenLogicProject/OpenLogic.git"
      checkout: "master"
    gates_override:
      add: ["extract_text_chunks"]
    output:
      pool: "permissive"
      formats: ["git", "jsonl.gz"]
    routing:
      subject: logic
      domain: first_order_logic
      category: translation_quantifiers
      granularity: target

  - id: "forallx_calgarystyle"
    name: "forall x (open logic textbook; Calgary-style edition)"
    enabled: false
    priority: 7
    publisher: "forallx"
    license_profile: "permissive"
    license_evidence:
      spdx_hint: "UNKNOWN"
      url: ""
    data_type: ["textbooks", "logic", "exercises"]
    download:
      strategy: "git"
      repo: ""
      checkout: "main"
    notes: "Fill repo + LICENSE url for the exact edition you want (license can differ by edition)."
    output:
      pool: "permissive"
      formats: ["git", "jsonl.gz"]
    routing:
      subject: logic
      domain: first_order_logic
      category: translation_quantifiers
      granularity: target

  - id: "smtlib_benchmarks"
    name: "SMT-LIB benchmarks (mixed submitter licensing; treat as record-level)"
    enabled: true
    priority: 8
    publisher: "smtlib"
    license_profile: "record_level"
    license_evidence:
      spdx_hint: "MIXED"
      url: "https://smt-lib.org"
    data_type: ["benchmarks", "smt", "smt2"]
    download:
      strategy: "git"
      repo: "https://github.com/SMT-LIB/benchmarks.git"
      checkout: "master"
    gates_override:
      add: ["record_level_filter"]
    output:
      pool: "quarantine"
      formats: ["git"]
    routing:
      subject: logic
      domain: automated_reasoning
      category: smt_benchmarks
      granularity: target

  - id: "smtlib_format"
    name: "SMT-LIB format + docs"
    enabled: true
    priority: 6
    publisher: "smtlib"
    license_profile: "permissive"
    license_evidence:
      spdx_hint: "UNKNOWN"
      url: "https://raw.githubusercontent.com/SMT-LIB/SMT-LIB-2/master/LICENSE"
    data_type: ["specs", "smt", "documentation"]
    download:
      strategy: "git"
      repo: "https://github.com/SMT-LIB/SMT-LIB-2.git"
      checkout: "master"
    output:
      pool: "permissive"
      formats: ["git"]
    routing:
      subject: logic
      domain: automated_reasoning
      category: smt_benchmarks
      granularity: target

  - id: "sat_competition_benchmarks"
    name: "SAT Competition benchmark corpora (license varies; quarantine by default)"
    enabled: false
    priority: 6
    publisher: "satcompetition"
    license_profile: "record_level"
    license_evidence:
      spdx_hint: "UNKNOWN"
      url: ""
    data_type: ["benchmarks", "sat", "dimacs"]
    download:
      strategy: "http"
      urls: []
    notes: "Prefer an official archive with explicit license; otherwise keep in quarantine and extract only problem instances if permitted."
    output:
      pool: "quarantine"
      formats: ["zip", "tar.gz"]
    routing:
      subject: logic
      domain: automated_reasoning
      category: sat_benchmarks
      granularity: target

  - id: "rule_taker"
    name: "RuleTaker (rule-based reasoning; NL+rules)"
    enabled: false
    priority: 7
    publisher: "allenai"
    license_profile: "permissive"
    license_evidence:
      spdx_hint: "UNKNOWN"
      url: ""
    data_type: ["nl_reasoning", "rules", "entailment"]
    download:
      strategy: "huggingface_datasets"
      dataset_id: "allenai/ruletaker"
    canonicalize:
      text_field_candidates: ["text", "context", "question", "rules", "story"]
    notes: "Confirm dataset_id + license in dataset card, then set license_evidence.url to the dataset card or repo LICENSE."
    output:
      pool: "permissive"
      formats: ["hf_dataset"]
    routing:
      subject: logic
      domain: ai_reasoning_benchmarks
      category: rule_taker
      granularity: target

  - id: "proofwriter"
    name: "ProofWriter (synthetic logical reasoning)"
    enabled: false
    priority: 7
    publisher: "allenai"
    license_profile: "permissive"
    license_evidence:
      spdx_hint: "UNKNOWN"
      url: ""
    data_type: ["nl_reasoning", "rules", "proof_chains"]
    download:
      strategy: "huggingface_datasets"
      dataset_id: "allenai/proofwriter"
    canonicalize:
      text_field_candidates: ["text", "context", "question", "theory", "proof"]
    notes: "Confirm license + dataset_id; then fill license_evidence.url."
    output:
      pool: "permissive"
      formats: ["hf_dataset"]
    routing:
      subject: logic
      domain: ai_reasoning_benchmarks
      category: proofwriter
      granularity: target

  - id: "folio"
    name: "FOLIO (first-order logic in NL; share-alike)"
    enabled: false
    priority: 5
    publisher: "folio"
    license_profile: "copyleft"
    license_evidence:
      spdx_hint: "UNKNOWN"
      url: ""
    data_type: ["nl_reasoning", "fol", "entailment"]
    download:
      strategy: "huggingface_datasets"
      dataset_id: ""
    canonicalize:
      text_field_candidates: ["text", "story", "context", "question", "answer"]
    gates_override:
      add: ["manual_legal_review", "segregate_copyleft_pool"]
    output:
      pool: "copyleft"
      formats: ["hf_dataset"]
    routing:
      subject: logic
      domain: ai_reasoning_benchmarks
      category: folio
      granularity: target

  - id: "commonpile_logic_slice"
    name: "CommonPile slice: logic / theorem proving / formal methods (record-level)"
    enabled: false
    priority: 9
    publisher: "commonpile"
    license_profile: "record_level"
    license_evidence:
      spdx_hint: "MIXED"
      url: ""
    data_type: ["commonpile", "nl_text", "logic"]
    download:
      strategy: "none"
    ingest:
      local_shards_glob: "/data/commonpile/**/*.jsonl.zst"
      topic_query:
        include_terms:
          - "logic"
          - "propositional logic"
          - "first-order logic"
          - "modal logic"
          - "theorem prover"
          - "proof assistant"
          - "SMT"
          - "SAT"
          - "formal verification"
          - "type theory"
        exclude_terms:
          - "astrology"
          - "tarot"
    gates_override:
      add: ["record_level_filter", "extract_text_chunks"]
    output:
      pool: "quarantine"
      formats: ["jsonl.zst", "jsonl.gz"]
    routing:
      subject: logic
      domain: informal_reasoning
      category: validity_soundness
      granularity: target

  - id: "wikipedia_en_logic"
    name: "Wikipedia EN dumps (logic-related pages)"
    enabled: false
    priority: 4
    publisher: "wikimedia"
    license_profile: "copyleft"
    license_evidence:
      spdx_hint: "UNKNOWN"
      url: "https://en.wikipedia.org/wiki/Wikipedia:Copyrights"
    data_type: ["text", "encyclopedia", "logic"]
    download:
      strategy: "http"
      urls:
        - "https://dumps.wikimedia.org/enwiki/latest/enwiki-latest-pages-articles.xml.bz2"
    gates_override:
      add: ["manual_legal_review", "segregate_copyleft_pool", "extract_text_chunks"]
    output:
      pool: "copyleft"
      formats: ["bz2", "jsonl.gz"]
    routing:
      subject: logic
      domain: informal_reasoning
      category: validity_soundness
      granularity: target

  - id: "stackexchange_logic"
    name: "Stack Exchange data dump (Logic / Math / CS Theory tags; share-alike)"
    enabled: false
    priority: 4
    publisher: "stackexchange"
    license_profile: "copyleft"
    license_evidence:
      spdx_hint: "UNKNOWN"
      url: ""
    data_type: ["qna", "logic", "proofs"]
    download:
      strategy: "http"
      urls: []
    gates_override:
      add: ["manual_legal_review", "segregate_copyleft_pool", "extract_text_chunks"]
    output:
      pool: "copyleft"
      formats: ["7z", "xml", "jsonl.gz"]
    routing:
      subject: logic
      domain: informal_reasoning
      category: validity_soundness
      granularity: target

  - id: "tptp_problem_library"
    name: "TPTP Problem Library (restrictive redistribution terms for modified versions)"
    enabled: false
    notes: "Disabled until license evidence URL and download URL are confirmed."
    priority: 1
    publisher: "tptp"
    license_profile: "deny"
    license_evidence:
      spdx_hint: "Custom-Restrictive"
      url: ""
    data_type: ["benchmarks", "atp"]
    download:
      strategy: "http"
      urls: []
    output:
      pool: "quarantine"
      formats: []
    routing:
      subject: logic
      domain: automated_reasoning
      category: tptp_atp
      granularity: target

  - id: "sep_stanford_encyclopedia_of_philosophy"
    name: "Stanford Encyclopedia of Philosophy (copyrighted; not a training corpus)"
    enabled: false
    priority: 1
    publisher: "stanford"
    license_profile: "deny"
    license_evidence:
      spdx_hint: "All-Rights-Reserved"
      url: "https://plato.stanford.edu"
    data_type: ["reference", "philosophy", "logic"]
    download:
      strategy: "none"
    output:
      pool: "quarantine"
      formats: []
    routing:
      subject: logic
      domain: philosophy_logic
      category: sep_logic
      granularity: target
