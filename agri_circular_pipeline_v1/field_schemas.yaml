# field_schemas.yaml
# v0.7 â€” Agriculture + Waste Streams + Circular Bioeconomy schemas
#
# Each schema version is immutable once released. Create a new version for changes.
# This ensures reproducibility: you can always know exactly what fields were extracted.

schema_version: "0.7"
updated_utc: "2025-12-17"

schemas:

  echo_facility_record.v1:
    description: "EPA ECHO facility registry record (FRS + program IDs)"
    version: "1.0.0"
    created_utc: "2025-12-17"
    source: "echo_frs"
    fields:
      facility_id:
        description: "Primary facility identifier"
        type: "string"
        required: true
        nullable: false
      frs_registry_id:
        description: "FRS registry identifier"
        type: "string"
        required: false
        nullable: true
      site_name:
        description: "Facility or site name"
        type: "string"
        required: false
        nullable: true
      program:
        description: "Regulatory program (RCRA, NPDES, SDWA, etc.)"
        type: "string"
        required: true
        nullable: false
      permit_id:
        description: "Program-specific permit or handler ID"
        type: "string"
        required: false
        nullable: true
      address:
        description: "Street address"
        type: "string"
        required: false
        nullable: true
      city:
        description: "City"
        type: "string"
        required: false
        nullable: true
      state:
        description: "State or province code"
        type: "string"
        required: false
        nullable: true
      postal_code:
        description: "Postal or ZIP code"
        type: "string"
        required: false
        nullable: true
      country:
        description: "Country code"
        type: "string"
        required: false
        nullable: true
      county_fips:
        description: "County FIPS code when available"
        type: "string"
        required: false
        nullable: true
      latitude:
        description: "Latitude in decimal degrees"
        type: "float"
        required: false
        nullable: true
        validation:
          min: -90
          max: 90
      longitude:
        description: "Longitude in decimal degrees"
        type: "float"
        required: false
        nullable: true
        validation:
          min: -180
          max: 180
      status:
        description: "Facility operating/compliance status"
        type: "string"
        required: false
        nullable: true
      last_inspection_date:
        description: "Most recent inspection date (ISO 8601)"
        type: "string"
        required: false
        nullable: true
      naics_sic:
        description: "Industry classification codes (NAICS/SIC)"
        type: "string"
        required: false
        nullable: true
      hazard_category:
        description: "Hazard or waste category flags"
        type: "string"
        required: false
        nullable: true

    output_record:
      id_field: "facility_id"
      mappings:
        id: "facility_id"
        name: "site_name"
        program: "program"
        permit_id: "permit_id"
        address: "address"
        city: "city"
        state: "state"
        postal_code: "postal_code"
        country: "country"
        county_fips: "county_fips"
        latitude: "latitude"
        longitude: "longitude"
        status: "status"
        last_inspection_date: "last_inspection_date"
        naics_sic: "naics_sic"
        hazard_category: "hazard_category"

  echo_permit_record.v1:
    description: "Permit or handler record associated with an ECHO facility"
    version: "1.0.0"
    created_utc: "2025-12-17"
    source: "echo_permits"
    fields:
      permit_id:
        description: "Program-specific permit ID"
        type: "string"
        required: true
        nullable: false
      facility_id:
        description: "Linked facility identifier"
        type: "string"
        required: false
        nullable: true
      program:
        description: "Regulatory program (RCRA, NPDES, SDWA, etc.)"
        type: "string"
        required: true
        nullable: false
      permit_type:
        description: "Permit subtype or handler class"
        type: "string"
        required: false
        nullable: true
      effective_date:
        description: "Permit effective date (ISO 8601)"
        type: "string"
        required: false
        nullable: true
      expiration_date:
        description: "Permit expiration date (ISO 8601)"
        type: "string"
        required: false
        nullable: true
      status:
        description: "Current permit status"
        type: "string"
        required: false
        nullable: true
      pollutants:
        description: "Optional pollutant list or category"
        type: "string"
        required: false
        nullable: true

    output_record:
      id_field: "permit_id"
      mappings:
        id: "permit_id"
        facility_id: "facility_id"
        program: "program"
        permit_type: "permit_type"
        effective_date: "effective_date"
        expiration_date: "expiration_date"
        status: "status"
        pollutants: "pollutants"

  waste_stream_event.v1:
    description: "Event-level waste stream record with unit-normalized quantities"
    version: "1.0.0"
    created_utc: "2025-12-17"
    source: "echo_dmrs_or_rcra_events"
    fields:
      event_id:
        description: "Unique event identifier"
        type: "string"
        required: true
        nullable: false
      facility_id:
        description: "Facility identifier"
        type: "string"
        required: true
        nullable: false
      stream_type:
        description: "Wastewater, hazardous waste, biosolids, etc."
        type: "string"
        required: true
        nullable: false
      pollutant:
        description: "Pollutant or parameter name"
        type: "string"
        required: false
        nullable: true
      quantity_value:
        description: "Measured or reported quantity"
        type: "float"
        required: false
        nullable: true
      quantity_unit:
        description: "Unit for quantity_value (normalized)"
        type: "string"
        required: false
        nullable: true
      measurement_date:
        description: "Event or measurement date (ISO 8601)"
        type: "string"
        required: false
        nullable: true
      method:
        description: "Sampling or analytical method"
        type: "string"
        required: false
        nullable: true
      compliance_status:
        description: "Compliance flag if applicable"
        type: "string"
        required: false
        nullable: true

    output_record:
      id_field: "event_id"
      mappings:
        id: "event_id"
        facility_id: "facility_id"
        stream_type: "stream_type"
        pollutant: "pollutant"
        quantity_value: "quantity_value"
        quantity_unit: "quantity_unit"
        measurement_date: "measurement_date"
        method: "method"
        compliance_status: "compliance_status"

  agrovoc_term.v1:
    description: "AGROVOC concept table with multilingual labels"
    version: "1.0.0"
    created_utc: "2025-12-17"
    source: "agrovoc"
    fields:
      term_id:
        description: "AGROVOC concept URI or identifier"
        type: "string"
        required: true
        nullable: false
      pref_label:
        description: "Preferred label"
        type: "string"
        required: true
        nullable: false
      alt_labels:
        description: "Alternative labels / synonyms"
        type: "array"
        items_type: "string"
        required: false
        nullable: true
      language:
        description: "Language code for labels"
        type: "string"
        required: false
        nullable: true
      broader:
        description: "Broader parent term IDs"
        type: "array"
        items_type: "string"
        required: false
        nullable: true
      narrower:
        description: "Narrower child term IDs"
        type: "array"
        items_type: "string"
        required: false
        nullable: true

    output_record:
      id_field: "term_id"
      mappings:
        id: "term_id"
        pref_label: "pref_label"
        alt_labels: "alt_labels"
        language: "language"
        broader: "broader"
        narrower: "narrower"

  lca_process_stub.v1:
    description: "Metadata-only LCA process stub (keeps license + provenance)"
    version: "1.0.0"
    created_utc: "2025-12-17"
    source: "lca_metadata"
    fields:
      process_id:
        description: "Identifier for the LCA process"
        type: "string"
        required: true
        nullable: false
      name:
        description: "Process name"
        type: "string"
        required: true
        nullable: false
      category:
        description: "Process category (e.g., agriculture, waste treatment)"
        type: "string"
        required: false
        nullable: true
      region:
        description: "Geographic region"
        type: "string"
        required: false
        nullable: true
      data_source:
        description: "Source dataset or publication"
        type: "string"
        required: false
        nullable: true
      license:
        description: "License for the process metadata"
        type: "string"
        required: false
        nullable: true
      retrieval_date:
        description: "When the metadata was retrieved"
        type: "string"
        required: false
        nullable: true

    output_record:
      id_field: "process_id"
      mappings:
        id: "process_id"
        name: "name"
        category: "category"
        region: "region"
        data_source: "data_source"
        license: "license"
        retrieval_date: "retrieval_date"

  geospatial_tile_manifest.v1:
    description: "Manifest entry for geospatial tiles or summaries"
    version: "1.0.0"
    created_utc: "2025-12-17"
    source: "geospatial_tiles"
    fields:
      tile_id:
        description: "Unique tile identifier"
        type: "string"
        required: true
        nullable: false
      source_dataset:
        description: "Name of dataset (e.g., NLCD, SSURGO raster)"
        type: "string"
        required: true
        nullable: false
      bbox:
        description: "Bounding box [minx, miny, maxx, maxy]"
        type: "array"
        items_type: "float"
        required: true
        nullable: false
      crs:
        description: "Coordinate reference system (e.g., EPSG:4326)"
        type: "string"
        required: true
        nullable: false
      resolution_meters:
        description: "Resolution in meters"
        type: "float"
        required: false
        nullable: true
      format:
        description: "Tile or archive format"
        type: "string"
        required: false
        nullable: true
      uri:
        description: "Location of the tile in storage"
        type: "string"
        required: true
        nullable: false
      checksum:
        description: "Checksum for integrity verification"
        type: "string"
        required: false
        nullable: true

    output_record:
      id_field: "tile_id"
      mappings:
        id: "tile_id"
        source_dataset: "source_dataset"
        bbox: "bbox"
        crs: "crs"
        resolution_meters: "resolution_meters"
        format: "format"
        uri: "uri"
        checksum: "checksum"
