# denylist.yaml
# v0.2 â€” explicit denylist patterns (v0.9 enhancements)
#
# The pipeline scans target id/name, license evidence URL, and download config.
# v0.9 NEW: Structured patterns, per-pattern severity, and mandatory provenance.
#
# Severity levels:
#   - hard_red: Forces RED immediately (default, backwards compatible)
#   - force_yellow: Forces YELLOW for deeper manual review
#
# All patterns now require 'link' and 'rationale' fields for auditability.

schema_version: "0.2"
updated_utc: "2025-12-20"

# v0.9: Domain extraction patterns (match against extracted domain from URLs)
domain_patterns: []
  # Example:
  # - domain: "example.com"
  #   severity: "hard_red"
  #   link: "https://example.com/terms"
  #   rationale: "Terms explicitly prohibit ML training"

# v0.9: Publisher/provider tags (match against publisher metadata if available)
publisher_patterns: []
  # Example:
  # - publisher: "Example Publisher"
  #   severity: "force_yellow"
  #   link: "https://publisher.example/policy"
  #   rationale: "Unclear terms, needs manual review"

patterns:
  # Example pattern with v0.9 required provenance fields:
  # - type: "substring"        # substring | regex | domain
  #   value: "example.com"
  #   fields: ["license_evidence_url", "download_blob"]
  #   severity: "hard_red"     # hard_red (default) | force_yellow
  #   link: "https://example.com/terms"
  #   rationale: "Terms prohibit text mining and AI training"

  # Placeholder patterns (add your denylisted sources here)
  # Metrology-specific restrictions to watch for (distribution/export control)
  - type: "substring"
    value: "distribution statement"
    fields: ["license_evidence_url", "download_blob", "name"]
    severity: "force_yellow"
    link: "https://sti.nasa.gov/distribution-categories/"
    rationale: "Presence of Distribution A/B/C/D statements requires manual review"

  - type: "substring"
    value: "export controlled"
    fields: ["license_evidence_url", "download_blob", "name"]
    severity: "hard_red"
    link: "https://www.trade.gov/itar-and-ear"
    rationale: "Export-controlled content should be rejected or isolated"

  # - type: "substring"
  #   value: "restricted-publisher.com"
  #   fields: ["license_evidence_url", "download_blob", "id", "name"]
  #   severity: "hard_red"
  #   link: "https://restricted-publisher.com/legal"
  #   rationale: "Publisher explicitly prohibits AI/ML training in their terms of service"

  # - type: "regex"
  #   value: "(?i)proprietary.*dataset"
  #   fields: ["name", "id"]
  #   severity: "force_yellow"
  #   link: ""
  #   rationale: "Datasets with 'proprietary' in name require manual license verification"

  # - type: "domain"
  #   value: "paywalled-journal.com"
  #   fields: ["license_evidence_url", "download_blob"]
  #   severity: "hard_red"
  #   link: "https://paywalled-journal.com/terms"
  #   rationale: "Journal requires subscription and prohibits bulk download/training"
