# denylist.yaml
# v0.3 â€” explicit denylist patterns for cyber pipeline (v0.9 enhancements)
#
# The pipeline scans target id/name, license evidence URL, and download config.
# Severity levels:
#   - hard_red: Forces RED immediately
#   - force_yellow: Forces YELLOW for deeper manual review
#
# All patterns require 'link' and 'rationale' fields for auditability.

schema_version: "0.3"
updated_utc: "2025-12-30"

domain_patterns:
  - domain: "exploit-db.com"
    severity: "hard_red"
    link: "https://www.exploit-db.com/terms"
    rationale: "Exploit PoC corpus; offensive payloads not allowed"
  - domain: "vx-underground.org"
    severity: "hard_red"
    link: "https://vx-underground.org/"
    rationale: "Malware corpus; excluded for safety"
  - domain: "raidforums.com"
    severity: "hard_red"
    link: "https://raidforums.com"
    rationale: "Credential/breach dumps"

publisher_patterns:
  - publisher: "Offensive Security"
    severity: "hard_red"
    link: "https://www.kali.org/"
    rationale: "Offensive/pentest payload focus; unsuitable for defender corpus"

patterns:
  - type: "regex"
    value: "(?i)(password=|api[_-]?key=|BEGIN PRIVATE KEY|AWS[0-9A-Z]{16})"
    fields: ["download_blob", "name"]
    severity: "force_yellow"
    link: "https://owasp.org/www-community/attacks/Source_Code_Download"
    rationale: "Secrets detected; require quarantine or redaction"

  - type: "regex"
    value: "(?i)(exploit[- ]?db|metasploit module|poc exploits|shellcode archive)"
    fields: ["name", "id", "download_blob"]
    severity: "hard_red"
    link: "https://www.exploit-db.com/terms"
    rationale: "Offensive exploit payload sources"

  - type: "substring"
    value: "malware dataset"
    fields: ["name", "download_blob"]
    severity: "hard_red"
    link: "https://vx-underground.org/"
    rationale: "Malware corpora excluded"

  - type: "substring"
    value: "credential dump"
    fields: ["name", "download_blob"]
    severity: "hard_red"
    link: "https://en.wikipedia.org/wiki/Data_breach"
    rationale: "Breach/credential dumps are not permitted"

  - type: "regex"
    value: "(?i)(attack walkthrough|privilege escalation guide|initial access playbook)"
    fields: ["name", "download_blob"]
    severity: "force_yellow"
    link: "https://attack.mitre.org"
    rationale: "Potential dual-use instructional content; requires manual review"
