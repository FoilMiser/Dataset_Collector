# targets.yaml
# v1.0 — physics/astronomy/high-energy corpus inventory
# Requires companion: ./license_map.yaml, ./field_schemas.yaml, ./denylist.yaml
# Adapted from chem_pipeline_v1 for physics-first datasets

schema_version: "0.8"
updated_utc: "2026-02-15"

companion_files:
  license_map: "./license_map.yaml"
  field_schemas: "./field_schemas.yaml"
  denylist: "./denylist.yaml"

globals:
  storage_root: "/data/physics"
  staging_root: "/data/physics/_staging"
  manifests_root: "/data/physics/_manifests"
  queues_root: "/data/physics/_queues"
  catalogs_root: "/data/physics/_catalogs"
  logs_root: "/data/physics/_logs"

  pools:
    permissive: "/data/physics/pools/permissive"
    copyleft: "/data/physics/pools/copyleft"
    quarantine: "/data/physics/pools/quarantine"

  require_yellow_signoff: false

  near_duplicate_detection:
    enabled: false
    method: "minhash_lsh"
    num_perm: 128
    threshold: 0.8
    emit_duplicate_groups: true

  parquet_output:
    enabled: false
    compression: "snappy"
    row_group_size: 100000

  normalization:
    enabled: false
    rdkit_canonicalize: true
    validate_inchikey: true
    report_coverage: true

  default_gates:
    - "snapshot_terms"
    - "resolve_license_spdx"
    - "restriction_phrase_scan"
    - "emit_training_manifest"
    - "emit_attribution_bundle"

  download_defaults:
    retry_max: 3
    retry_backoff_base: 2.0
    retry_backoff_max: 60
    timeout_connect: 30
    timeout_read: 300
    verify_checksums: true
    enable_resume: true
    max_concurrent_workers: 4
    user_agent: "physics-corpus-pipeline/1.0"

  text_processing_defaults:
    max_chunk_chars: 6000
    min_chunk_chars: 500
    drop_tables: false
    drop_references_section: true
    keep_citations_inline: false
    include_section_headers: true
    include_figure_captions: true
    include_table_captions: true

  statistics_defaults:
    estimate_tokens: true
    token_model: "cl100k_base"
    collect_property_distributions: true
    sample_size_for_distributions: 10000

queues:
  emit:
    - id: "green_download"
      path: "/data/physics/_queues/green_download.jsonl"
      criteria:
        effective_bucket: "GREEN"
        enabled: true
    - id: "yellow_pipeline"
      path: "/data/physics/_queues/yellow_pipeline.jsonl"
      criteria:
        effective_bucket: "YELLOW"
        enabled: true
    - id: "red_rejected"
      path: "/data/physics/_queues/red_rejected.jsonl"
      criteria:
        effective_bucket: "RED"
        enabled: true

gates_catalog:
  snapshot_terms: "Save Terms/ToS + license page HTML/PDF + retrieval timestamp."
  resolve_license_spdx: "Normalize license to SPDX via license_map.yaml rules; store evidence."
  restriction_phrase_scan: "Scan terms/content for restriction phrases (no-LLM/no-TDM/etc.)."
  record_level_filter: "Require per-record license metadata; keep only allowlist."
  computed_only_extract: "Extract only safe computed identifiers/descriptors; drop depositor text."
  extract_text_chunks: "Extract text into JSONL chunks using globals.text_processing_defaults unless overridden."
  emit_training_manifest: "Manifest of included files/records + checksums + license evidence."
  emit_attribution_bundle: "Generate ATTRIBUTION.md + CITATIONS.bib for included sources."

targets:

  # =========================
  # Physics / Astronomy / HEP
  # =========================

  - id: cern_open_data_portal
    name: CERN Open Data Portal (HEP datasets, software, docs)
    enabled: true
    priority: 85
    license_profile: permissive
    license_evidence:
      spdx_hint: CC0-1.0
      url: https://opendata.cern.ch/docs/terms-of-use
    data_type: [experimental_data, documentation, metadata]
    download:
      strategy: http
      urls:
        - https://opendata.cern.ch/
        - https://opendata.cern.ch/docs/about
    output:
      pool: permissive
      formats: [html]
    statistics: {}

  - id: hepdata_cc0
    name: HEPData (structured HEP tables; CC0 default)
    enabled: true
    priority: 80
    license_profile: permissive
    license_evidence:
      spdx_hint: CC0-1.0
      url: https://www.hepdata.net/terms
    data_type: [experimental_data, tables, metadata]
    download:
      strategy: http
      urls:
        - https://www.hepdata.net/search?phrase=collaborations%3AATLAS&format=json
        - https://www.hepdata.net/search?phrase=collaborations%3ACMS&format=json
        - https://www.hepdata.net/search?phrase=collaborations%3AALICE&format=json
        - https://www.hepdata.net/search?phrase=collaborations%3ALHCb&format=json
    output:
      pool: permissive
      formats: [json]
    statistics: {}

  - id: gwosc_gravitational_waves
    name: GWOSC (LIGO/Virgo/KAGRA open gravitational-wave data)
    enabled: true
    priority: 80
    license_profile: permissive
    license_evidence:
      spdx_hint: CC-BY-4.0
      url: https://gwosc.org/about/license/
    data_type: [time_series, event_catalog, experimental_data]
    download:
      strategy: http
      urls:
        - https://gwosc.org/eventapi/json/
        - https://gwosc.org/
    output:
      pool: permissive
      formats: [json, html]
    statistics: {}

  - id: noaa_ncei_api
    name: NOAA NCEI Data Access API (meteorology/ocean/geo)
    enabled: true
    priority: 70
    license_profile: permissive
    license_evidence:
      spdx_hint: PUBLIC-DOMAIN
      url: https://oceanservice.noaa.gov/about/faq.html
    data_type: [geoscience_data, time_series, gridded_data, metadata]
    download:
      strategy: http
      urls:
        - https://www.ncei.noaa.gov/access/services/data/v1
        - https://www.ncei.noaa.gov/access/services/data/v1?datasets=global-hourly&startDate=2020-01-01&endDate=2020-01-02&format=json
    output:
      pool: permissive
      formats: [json]
    statistics: {}

  - id: nws_weather_api
    name: NOAA/NWS API (weather.gov)
    enabled: true
    priority: 60
    license_profile: permissive
    license_evidence:
      spdx_hint: PUBLIC-DOMAIN
      url: https://www.weather.gov/disclaimer
    data_type: [time_series, geoscience_data, metadata]
    download:
      strategy: http
      urls:
        - https://api.weather.gov/
        - https://api.weather.gov/alerts/active
    output:
      pool: permissive
      formats: [json]
    statistics: {}

  - id: usgs_national_map_public_domain
    name: USGS The National Map + public-domain datasets
    enabled: true
    priority: 65
    license_profile: permissive
    license_evidence:
      spdx_hint: PUBLIC-DOMAIN
      url: https://www.usgs.gov/faqs/are-usgs-reportspublications-copyrighted
    data_type: [geoscience_data, maps, metadata]
    download:
      strategy: http
      urls:
        - https://www.usgs.gov/faqs/what-are-terms-uselicensing-map-services-and-data-national-map
        - https://www.usgs.gov/information-policies-and-instructions/acknowledging-or-crediting-usgs
    output:
      pool: permissive
      formats: [html]
    statistics: {}

  - id: nasa_public_domain_materials
    name: NASA public-domain materials + APIs (with third-party caveat)
    enabled: true
    priority: 65
    license_profile: permissive
    license_evidence:
      spdx_hint: PUBLIC-DOMAIN
      url: https://sti.nasa.gov/disclaimers/
    data_type: [documentation, metadata, datasets]
    download:
      strategy: http
      urls:
        - https://api.nasa.gov/
        - https://sti.nasa.gov/disclaimers/
        - https://www.nasa.gov/nasa-brand-center/
    output:
      pool: permissive
      formats: [html, json]
    statistics: {}

  - id: eso_science_archive_ccby
    name: ESO Science Archive Facility (astronomy data)
    enabled: true
    priority: 70
    license_profile: permissive
    license_evidence:
      spdx_hint: CC-BY-4.0
      url: https://archive.eso.org/cms/eso-data-access-policy.html
    data_type: [observational_data, metadata]
    download:
      strategy: http
      urls:
        - https://archive.eso.org/cms/eso-data-access-policy.html
        - https://archive.eso.org/
    output:
      pool: permissive
      formats: [html]
    statistics: {}

  - id: sdss_bulk_downloads
    name: Sloan Digital Sky Survey (SDSS) public releases
    enabled: true
    priority: 70
    license_profile: permissive
    license_evidence:
      spdx_hint: PUBLIC-DOMAIN
      url: https://www.sdss4.org/collaboration/
    data_type: [observational_data, catalogs, images]
    download:
      strategy: http
      urls:
        - https://sdss.org/dr18/data_access/bulk/
        - https://www.sdss.org/collaboration/image-use-policy/
    output:
      pool: permissive
      formats: [html]
    statistics: {}

  # =========================
  # Physics-of-materials corpora
  # =========================

  - id: materials_project_ccby
    name: Materials Project / GNoME Database (materials physics)
    enabled: true
    priority: 75
    license_profile: permissive
    license_evidence:
      spdx_hint: CC-BY-4.0
      url: https://next-gen.materialsproject.org/about/terms
    data_type: [materials_data, computed_properties, metadata]
    download:
      strategy: http
      urls:
        - https://next-gen.materialsproject.org/about/terms
        - https://next-gen.materialsproject.org/api
    output:
      pool: permissive
      formats: [html, json]
    statistics: {}

  - id: nomad_ccby
    name: NOMAD (materials science data; CC BY, metadata CC0)
    enabled: true
    priority: 75
    license_profile: permissive
    license_evidence:
      spdx_hint: CC-BY-4.0
      url: https://nomad-lab.eu/nomad-lab/terms.html
    data_type: [materials_data, computed_properties, metadata]
    download:
      strategy: http
      urls:
        - https://nomad-lab.eu/nomad-lab/terms.html
        - https://nomad-lab.eu/
    output:
      pool: permissive
      formats: [html]
    statistics: {}

  - id: oqmd_ccby
    name: OQMD (Open Quantum Materials Database; CC BY)
    enabled: true
    priority: 70
    license_profile: permissive
    license_evidence:
      spdx_hint: CC-BY-4.0
      url: https://oqmd.org/
    data_type: [materials_data, computed_properties, metadata]
    download:
      strategy: http
      urls:
        - https://oqmd.org/
        - https://oqmd.org/documentation/publications
    output:
      pool: permissive
      formats: [html]
    statistics: {}

  - id: open_catalyst_oc20_oc22
    name: Open Catalyst Project (OC20/OC22; CC BY)
    enabled: true
    priority: 75
    license_profile: permissive
    license_evidence:
      spdx_hint: CC-BY-4.0
      url: https://opencatalystproject.org/
    data_type: [materials_data, ml_dataset, computed_properties]
    download:
      strategy: http
      urls:
        - https://opencatalystproject.org/
        - https://github.com/Open-Catalyst-Project/ocp/blob/main/LICENSE.md
    output:
      pool: permissive
      formats: [html]
    statistics: {}

  # =========================
  # Copyleft / Record-level
  # =========================

  - id: icecube_public_data_releases
    name: IceCube public data releases (some releases LGPL)
    enabled: true
    priority: 60
    license_profile: copyleft
    license_evidence:
      spdx_hint: LGPL-3.0-or-later
      url: https://icecube.wisc.edu/data-releases/2021/12/hese-7-5-year-data/
    data_type: [event_catalog, experimental_data, time_series]
    download:
      strategy: http
      urls:
        - https://icecube.wisc.edu/science/data-releases/
        - https://icecube.wisc.edu/data-releases/2021/12/hese-7-5-year-data/
    output:
      pool: copyleft
      formats: [html]
    statistics: {}

  - id: arxiv_oai_physics_metadata
    name: arXiv OAI-PMH (physics metadata; full text is per-paper license)
    enabled: true
    priority: 65
    license_profile: record_level
    license_evidence:
      spdx_hint: RECORD-LEVEL
      url: https://info.arxiv.org/help/bulk_data.html
    data_type: [literature_metadata]
    download:
      strategy: http
      urls:
        - https://export.arxiv.org/oai2
        - https://info.arxiv.org/help/oa/index.html
    output:
      pool: record_level
      formats: [xml, html]
    statistics: {}

  - id: mast_archive_record_level
    name: MAST (STScI) archive – some copyrighted collections
    enabled: false
    priority: 40
    license_profile: record_level
    license_evidence:
      spdx_hint: RECORD-LEVEL
      url: https://archive.stsci.edu/publishing/data-use
    data_type: [observational_data, metadata]
    download:
      strategy: http
      urls:
        - https://archive.stsci.edu/publishing/data-use
        - https://www.stsci.edu/copyright
    output:
      pool: record_level
      formats: [html]
    statistics: {}

  - id: openkim_record_level
    name: OpenKIM (interatomic models; license varies by model)
    enabled: true
    priority: 55
    license_profile: record_level
    license_evidence:
      spdx_hint: RECORD-LEVEL
      url: https://openkim.org/kim-licensing-v2/
    data_type: [materials_models, metadata]
    download:
      strategy: http
      urls:
        - https://openkim.org/kim-licensing-v2/
        - https://openkim.org/
    output:
      pool: record_level
      formats: [html]
    statistics: {}

  # =========================
  # Disabled-by-default (review restrictions first)
  # =========================

  - id: inspirehep_api_restricted
    name: INSPIRE-HEP API (review terms before ingestion)
    enabled: false
    priority: 30
    license_profile: record_level
    license_evidence:
      spdx_hint: RESTRICTED-TERMS
      url: https://help.inspirehep.net/knowledge-base/terms-of-use/
    data_type: [literature_metadata]
    download:
      strategy: http
      urls:
        - https://inspirehep.net/api/literature
        - https://help.inspirehep.net/knowledge-base/terms-of-use/
    output:
      pool: record_level
      formats: [json, html]
    statistics: {}

  - id: gaia_esa_noncommercial
    name: ESA Gaia (CC BY-NC IGO; non-commercial)
    enabled: false
    priority: 20
    license_profile: record_level
    license_evidence:
      spdx_hint: CC-BY-NC-3.0-IGO
      url: https://www.cosmos.esa.int/web/gaia-users/license
    data_type: [catalogs, observational_data, metadata]
    download:
      strategy: http
      urls:
        - https://www.cosmos.esa.int/web/gaia-users/license
        - https://www.cosmos.esa.int/web/gaia/archive
    output:
      pool: record_level
      formats: [html]
    statistics: {}

  - id: jhtdb_requires_agreement
    name: Johns Hopkins Turbulence Database (token + agreement)
    enabled: false
    priority: 20
    license_profile: record_level
    license_evidence:
      spdx_hint: REQUIRES-AGREEMENT
      url: https://www.re3data.org/repository/r3d100011061
    data_type: [simulation_data, fluid_dynamics]
    download:
      strategy: http
      urls:
        - https://www.re3data.org/repository/r3d100011061
    output:
      pool: record_level
      formats: [html]
    statistics: {}
